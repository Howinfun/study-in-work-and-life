我们都知道，Redis 服务器有很多的默认配置值，例如数据库的数量，最大内存，AOF相关配置和RDB相关配置等等。我相信，关于 AOF 和 RDB 的配置大家都很熟悉，但是关于数据库数量和最大内存了，是不是恰恰很容易被阿加忽略？

是不是数据库数量可以无限大？是不是越多越好用？

最大内存用户是不是可以有多大就设置多大？还是说总会有限制呢？

下面我们来看看。

首先是最大内存：

最大内存确实是可以由用户设置的，而且设置多大是不受限制的，当然了，除了32位的机器。

redis 的 maxmemory 默认是0，即内存使用没有设置最大值

![122db179fdc4cbe28287ef509f32236](images\122db179fdc4cbe28287ef509f32236.png)

如果你在32位的服务器上部署 Redis 实例，它的最大可用内存将限制在 3 GB。

因为 32位的机器的最大只支持 4GB 的内存。而系统本身就需要一定的内存资源来支持运行，所以 32 位机器限制最大 3GB 可用内存是有必要的。因为这个最大可用内存会关乎于过期键的删除操作。

![1587870591066](images/1587870591066.png)

当然了如果用户自己设置了 maxmemory，那么这个值不能小于 1M。

![1587870607003](images/1587870607003.png)



dbnum：

redis 默认的数据库数量为 16

![1587870737434](images/1587870737434.png)

redis 不会限制用户要设置数据库的数量。

但是，有很多地方还是会对数据库数量做限制的，所以正常情况下，我们也不要设置过多的数据库数量。

例如过期键的检查：

一般情况下，过期键的函数只处理 REDIS_DBCORN_DBS_CALL 个数据库，即16个数据库，这也是为什么 Redis 默认就是 16个数据库的原因。

如果用户设置的数据库过大的，可能会导致后面的数据库的过期键永远得不到定期删除策略，而只能用于惰性删除，即等键被访问时才查询键是否过期，这样会导致后面的数据库存在很多过期键而浪费宝贵的内存空间。

![1587870871724](images/1587870871724.png)

![1587870829187](images/1587870829187.png)